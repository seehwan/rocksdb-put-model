<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V4 & V5 RocksDB Models: Detailed Technical Analysis</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 4px solid #3498db;
            padding-bottom: 15px;
            text-align: center;
            font-size: 2.5em;
        }
        h2 {
            color: #34495e;
            border-left: 5px solid #3498db;
            padding-left: 20px;
            margin-top: 40px;
            background-color: #f8f9fa;
            padding: 15px 20px;
            border-radius: 5px;
        }
        h3 {
            color: #2980b9;
            margin-top: 30px;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
        }
        h4 {
            color: #8e44ad;
            margin-top: 25px;
        }
        .hero-section {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        .model-card {
            background-color: #f8f9fa;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
            border-left: 5px solid #3498db;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .v4-card {
            border-left-color: #27ae60;
            background: linear-gradient(135deg, #d5f4e6 0%, #ffeaa7 100%);
        }
        .v5-card {
            border-left-color: #e74c3c;
            background: linear-gradient(135deg, #fab1a0 0%, #fd79a8 100%);
        }
        .code-container {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Fira Code', 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
            border-left: 4px solid #4299e1;
        }
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .performance-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 4px solid #3498db;
        }
        .champion-card {
            border-top-color: #f1c40f;
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
        }
        .good-card {
            border-top-color: #27ae60;
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
        }
        .poor-card {
            border-top-color: #e74c3c;
            background: linear-gradient(135deg, #fadbd8 0%, #f8d7da 100%);
        }
        .metric-large {
            font-size: 3em;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }
        .metric-label-large {
            text-align: center;
            font-size: 1.1em;
            color: #7f8c8d;
            margin-bottom: 15px;
        }
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }
        .comparison-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
        }
        .rank-1-row {
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
            font-weight: bold;
        }
        .rank-2-row {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            font-weight: bold;
        }
        .insight-panel {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #17a2b8;
        }
        .warning-panel {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #f39c12;
        }
        .failure-panel {
            background: linear-gradient(135deg, #fab1a0 0%, #fd79a8 100%);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #e74c3c;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #2980b9;
        }
        .stat-label {
            color: #7f8c8d;
            margin-top: 5px;
        }
        .formula-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            font-family: 'Fira Code', monospace;
        }
        ul.feature-list {
            list-style: none;
            padding-left: 0;
        }
        ul.feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        ul.feature-list li:before {
            content: "✓ ";
            color: #27ae60;
            font-weight: bold;
            margin-right: 8px;
        }
        ul.issue-list {
            list-style: none;
            padding-left: 0;
        }
        ul.issue-list li {
            padding: 8px 0;
            border-bottom: 1px solid #ecf0f1;
        }
        ul.issue-list li:before {
            content: "✗ ";
            color: #e74c3c;
            font-weight: bold;
            margin-right: 8px;
        }
        .toc-nav {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .toc-nav ul {
            list-style-type: none;
            padding-left: 0;
            columns: 2;
            column-gap: 30px;
        }
        .toc-nav li {
            margin: 10px 0;
            break-inside: avoid;
        }
        .toc-nav a {
            text-decoration: none;
            color: #2980b9;
            font-weight: 500;
        }
        .toc-nav a:hover {
            text-decoration: underline;
            color: #3498db;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>V4 & V5 RocksDB Put-Rate Models<br>Detailed Technical Analysis</h1>
        
        <div class="hero-section">
            <h2 style="color: white; border: none; margin: 0; padding: 0;">Complete Implementation Details and Performance Characteristics</h2>
            <p style="font-size: 1.2em; margin-top: 15px;">Based on Rigorous 2025-09-12 Experimental Analysis</p>
        </div>

        <div class="toc-nav">
            <h3>Navigation</h3>
            <ul>
                <li><a href="#technical-overview">Technical Overview</a></li>
                <li><a href="#v4-deep-dive">V4 Model Family Deep Dive</a></li>
                <li><a href="#v5-deep-dive">V5 Model Family Deep Dive</a></li>
                <li><a href="#parameter-independence">Parameter Independence Analysis</a></li>
                <li><a href="#performance-analysis">Performance Analysis</a></li>
                <li><a href="#implementation-guidelines">Implementation Guidelines</a></li>
                <li><a href="#research-insights">Research Insights</a></li>
                <li><a href="#conclusion">Conclusion</a></li>
            </ul>
        </div>

        <div id="technical-overview">
            <h2>Technical Overview</h2>
            
            <h3>Problem Statement</h3>
            <p>Predict RocksDB's sustainable put rate (S_max) for FillRandom workload across different operational phases, considering:</p>
            <ul>
                <li>Device I/O constraints</li>
                <li>LSM-tree compaction behavior</li>
                <li>Write/Read amplification effects</li>
                <li>System stability and temporal evolution</li>
            </ul>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">138k→109k</div>
                    <div class="stat-label">QPS Decline Observed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">120 min</div>
                    <div class="stat-label">Experiment Duration</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">73.9%</div>
                    <div class="stat-label">Device Degradation</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">4.3</div>
                    <div class="stat-label">Max WA+RA</div>
                </div>
            </ul>
        </div>

        <div id="v4-deep-dive">
            <h2>V4 Model Family - Deep Dive</h2>

            <div class="model-card v4-card">
                <h3>V4 Device Envelope Model - Champion Analysis</h3>
                
                <div class="insight-panel">
                    <h4>Core Philosophy: "Right Constraint, Not All Constraints"</h4>
                    <p>V4 operates on the principle that system performance is ultimately limited by a <strong>single dominant constraint</strong>: device I/O capacity. Rather than modeling all possible factors, V4 focuses exclusively on accurately capturing this primary limitation.</p>
                </div>

                <h4>Mathematical Foundation</h4>
                <div class="formula-box">
                    <strong>Core Formula:</strong><br>
                    S_max = (device_write_bw × 1024 × 1024) / 1040 × device_utilization<br><br>
                    
                    <strong>Where:</strong><br>
                    • device_write_bw: Measured device write bandwidth (MB/s)<br>
                    • device_utilization: Observed utilization ratio (phase-specific)<br>
                    • 1040: Average record size in bytes
                </div>

                <h4>Phase-Specific Calibration</h4>
                <div class="performance-grid">
                    <div class="performance-card champion-card">
                        <h5>Initial Phase</h5>
                        <div class="metric-large" style="color: #f39c12;">66.7%</div>
                        <div class="metric-label-large">Accuracy</div>
                        <p><strong>Utilization:</strong> 1.9%</p>
                        <p><strong>Characteristics:</strong> High volatility, underutilization</p>
                    </div>
                    <div class="performance-card champion-card">
                        <h5>Middle Phase</h5>
                        <div class="metric-large" style="color: #27ae60;">90.8%</div>
                        <div class="metric-label-large">Accuracy</div>
                        <p><strong>Utilization:</strong> 4.7%</p>
                        <p><strong>Characteristics:</strong> Compaction active, degraded device</p>
                    </div>
                    <div class="performance-card champion-card">
                        <h5>Final Phase</h5>
                        <div class="metric-large" style="color: #f1c40f;">86.6%</div>
                        <div class="metric-label-large">Accuracy (1st Place)</div>
                        <p><strong>Utilization:</strong> 4.6%</p>
                        <p><strong>Characteristics:</strong> Stable, high amplification</p>
                    </div>
                </div>

                <h4>Why V4 Works: Implicit Factor Integration</h4>
                <div class="insight-panel">
                    <p>V4's genius lies in how <strong>device_utilization</strong> implicitly captures:</p>
                    <ul class="feature-list">
                        <li><strong>Write Amplification Effects</strong>: Higher WA → Higher device usage → Lower utilization efficiency</li>
                        <li><strong>Compaction Overhead</strong>: More compaction → More I/O → Reflected in utilization</li>
                        <li><strong>System Stability</strong>: Stable systems → Consistent utilization patterns</li>
                        <li><strong>LSM-tree Maturity</strong>: Deeper trees → More complex I/O → Lower effective utilization</li>
                    </ul>
                </div>
            </div>

            <div class="model-card v4-card">
                <h3>V4.1 Temporal Enhanced Model</h3>
                
                <div class="insight-panel">
                    <h4>Philosophy: "Time-Aware Performance Evolution"</h4>
                    <p>V4.1 extends V4 by explicitly modeling how RocksDB performance characteristics evolve over time as the database transitions from empty to mature state.</p>
                </div>

                <h4>Temporal Factor Implementation</h4>
                <div class="code-container">
temporal_factors = {
    'initial': {
        'performance_factor': 0.3,    # Low performance (initialization state)
        'io_intensity': 0.8,          # High I/O intensity
        'stability': 0.2,             # Low stability
        'adaptation_factor': 0.1      # Low adaptation
    },
    'middle': {
        'performance_factor': 0.6,    # Medium performance (transition)
        'io_intensity': 0.6,          # Medium I/O intensity
        'stability': 0.5,             # Medium stability
        'adaptation_factor': 0.5      # Medium adaptation
    },
    'final': {
        'performance_factor': 0.9,    # High performance (stabilized)
        'io_intensity': 0.4,          # Low I/O intensity
        'stability': 0.8,             # High stability
        'adaptation_factor': 0.9      # High adaptation
    }
}
                </div>

                <div class="champion-card">
                    <h4>Outstanding Achievement</h4>
                    <div class="metric-large" style="color: #f1c40f;">96.9%</div>
                    <div class="metric-label-large">Middle Phase Accuracy - Highest Single Performance</div>
                    <p>V4.1's temporal modeling achieves the <strong>highest single-phase performance</strong> across all models and phases.</p>
                </div>
            </div>
        </div>

        <div id="v5-deep-dive">
            <h2>V5 Model Family - Deep Dive</h2>

            <div class="warning-panel">
                <h3>V5 Development Philosophy</h3>
                <h4>"Adaptive Intelligence Through Comprehensive Integration"</h4>
                <p>The V5 family represents attempts to create "intelligent" adaptive models that consider multiple factors simultaneously, automatically adjusting to different operational phases and conditions.</p>
                <p><strong>Fundamental Assumption</strong>: More factors = Better accuracy (PROVEN WRONG)</p>
            </div>

            <div class="model-card v5-card">
                <h3>V5 Original Adaptive Model</h3>
                
                <h4>Technical Approach</h4>
                <div class="code-container">
class V5OriginalModel:
    def __init__(self):
        self.models = [
            DeviceEnvelopeModel(),     # Base V4 approach
            AmplificationModel(),      # WA/RA modeling
            StabilityModel(),          # System stability
            TemporalModel()            # Time evolution
        ]
        self.ensemble_weights = [0.4, 0.3, 0.2, 0.1]
    
    def predict_s_max(self, data, phase):
        predictions = []
        for model in self.models:
            pred = model.predict(data, phase)
            predictions.append(pred)
        
        # Weighted ensemble combination
        ensemble_pred = sum(p * w for p, w in 
                          zip(predictions, self.ensemble_weights))
        return ensemble_pred
                </div>

                <div class="performance-grid">
                    <div class="performance-card champion-card">
                        <h5>Initial Phase</h5>
                        <div class="metric-large" style="color: #f1c40f;">86.4%</div>
                        <div class="metric-label-large">1st Place</div>
                        <p>Ensemble handles initial volatility excellently</p>
                    </div>
                    <div class="performance-card good-card">
                        <h5>Middle Phase</h5>
                        <div class="metric-large" style="color: #27ae60;">85.9%</div>
                        <div class="metric-label-large">3rd Place</div>
                        <p>Still competitive in transition</p>
                    </div>
                    <div class="performance-card poor-card">
                        <h5>Final Phase</h5>
                        <div class="metric-large" style="color: #e74c3c;">10.1%</div>
                        <div class="metric-label-large">FAILED</div>
                        <p>Complete ensemble collapse</p>
                    </div>
                </div>

                <div class="failure-panel">
                    <h4>Critical Failure Analysis</h4>
                    <p><strong>Root Cause</strong>: Ensemble instability when multiple models disagree in complex final phase</p>
                    <p><strong>Lesson</strong>: Ensemble approaches can amplify individual model weaknesses</p>
                </div>
            </div>

            <div class="model-card v5-card">
                <h3>V5 Evolution Timeline</h3>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>V5 Version</th>
                            <th>Key Innovation</th>
                            <th>Overall Accuracy</th>
                            <th>Main Achievement</th>
                            <th>Critical Flaw</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="rank-1-row">
                            <td><strong>V5 Original</strong></td>
                            <td>Ensemble Modeling</td>
                            <td><strong>60.8%</strong></td>
                            <td>Best V5 performance</td>
                            <td>Final phase collapse</td>
                        </tr>
                        <tr>
                            <td>V5 Improved v2</td>
                            <td>Phase Isolation</td>
                            <td>43.1%</td>
                            <td>Phase consistency</td>
                            <td>Core constraint failure</td>
                        </tr>
                        <tr>
                            <td>V5 Fine-Tuned</td>
                            <td>Precision Tuning</td>
                            <td>39.4%</td>
                            <td>Data-driven optimization</td>
                            <td>Cannot match V4 simplicity</td>
                        </tr>
                        <tr>
                            <td>V5 Independence</td>
                            <td>Redundancy Elimination</td>
                            <td>38.0%</td>
                            <td>High model stability</td>
                            <td>Performance ceiling</td>
                        </tr>
                        <tr>
                            <td>V5 Final</td>
                            <td>Complete Integration</td>
                            <td>27.8%</td>
                            <td>Comprehensive modeling</td>
                            <td>Over-complexity disaster</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="parameter-independence">
            <h2>Parameter Independence Analysis</h2>

            <div class="failure-panel">
                <h3>Critical Discovery: V5 Parameter Redundancy</h3>
                <p><strong>User Insight Confirmed</strong>: "V5 parameters are not independent of V4 parameters"</p>
                
                <h4>Statistical Evidence</h4>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">22</div>
                        <div class="stat-label">Strong Correlations (|r| > 0.8)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">9</div>
                        <div class="stat-label">Multicollinearity Issues (VIF > 5)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">-0.755</div>
                        <div class="stat-label">Redundancy-Performance Correlation</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">3</div>
                        <div class="stat-label">Exact Parameter Duplicates</div>
                    </div>
                </div>
            </div>

            <h3>Identified Redundancies</h3>
            
            <div class="code-container">
EXACT DUPLICATES FOUND:
✗ system_volatility = cv (identical values)
✗ system_stability = 1 - cv (perfect inverse)
✗ combined_amplification = wa + ra (simple mathematical sum)

DERIVED PARAMETERS FOUND:
✗ device_degradation = (initial_bw - current_bw) / initial_bw
  Evidence: degradation = (4116.6 - 1074.8) / 4116.6 = 73.9%

CAUSAL DEPENDENCIES IDENTIFIED:
✗ wa, ra are consequences of device_write_bw performance, not independent causes
✗ compaction_intensity correlates with wa/ra (sequential dependency)
✗ level_depth follows temporal progression (time-dependent)
            </div>

            <h3>Independence Violation Impact</h3>
            <div class="warning-panel">
                <h4>V5 Failure Mechanism</h4>
                <ol>
                    <li><strong>Start with V4's device constraint</strong> (good foundation)</li>
                    <li><strong>Add device_degradation</strong> (redundant - same information as device_bw change)</li>
                    <li><strong>Add WA constraint</strong> (dependent - consequence of device performance)</li>
                    <li><strong>Add RA constraint</strong> (dependent - consequence of WA)</li>
                    <li><strong>Add stability constraints</strong> (duplicate - same as CV in different forms)</li>
                    <li><strong>Result</strong>: 5-7x information redundancy → 0.3-0.7x performance</li>
                </ol>
            </div>
        </div>

        <div id="performance-analysis">
            <h2>Performance Analysis</h2>

            <h3>Comprehensive Performance Matrix</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Model</th>
                        <th>Initial Phase</th>
                        <th>Middle Phase</th>
                        <th>Final Phase</th>
                        <th>Overall Average</th>
                        <th>Consistency</th>
                        <th>Parameter Count</th>
                        <th>Redundancy Count</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="rank-1-row">
                        <td><strong>V4 Device</strong></td>
                        <td>66.7%</td>
                        <td>90.8%</td>
                        <td><strong>86.6%</strong></td>
                        <td><strong>81.4%</strong></td>
                        <td><strong>High</strong></td>
                        <td><strong>1</strong></td>
                        <td><strong>0</strong></td>
                    </tr>
                    <tr class="rank-2-row">
                        <td><strong>V4.1 Temporal</strong></td>
                        <td>68.5%</td>
                        <td><strong>96.9%</strong></td>
                        <td>70.5%</td>
                        <td><strong>78.6%</strong></td>
                        <td>Medium</td>
                        <td>2-3</td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td>V4.2 Enhanced</td>
                        <td>23.9%</td>
                        <td>96.0%</td>
                        <td>-28.5%</td>
                        <td>30.5%</td>
                        <td>Low</td>
                        <td>5-6</td>
                        <td>2</td>
                    </tr>
                    <tr>
                        <td>V5 Original</td>
                        <td><strong>86.4%</strong></td>
                        <td>85.9%</td>
                        <td>10.1%</td>
                        <td>60.8%</td>
                        <td>Low</td>
                        <td>5</td>
                        <td>1</td>
                    </tr>
                    <tr>
                        <td>V5 Fine-Tuned</td>
                        <td>56.8%</td>
                        <td>21.1%</td>
                        <td>40.1%</td>
                        <td>39.4%</td>
                        <td>High</td>
                        <td>5-7</td>
                        <td>2-3</td>
                    </tr>
                    <tr>
                        <td>V5 Independence</td>
                        <td>56.8%</td>
                        <td>27.8%</td>
                        <td>29.4%</td>
                        <td>38.0%</td>
                        <td>High</td>
                        <td>1-4</td>
                        <td>0</td>
                    </tr>
                    <tr>
                        <td>V5 Final</td>
                        <td>46.6%</td>
                        <td>21.1%</td>
                        <td>15.7%</td>
                        <td>27.8%</td>
                        <td>Medium</td>
                        <td>7</td>
                        <td>3</td>
                    </tr>
                </tbody>
            </table>

            <h3>Key Performance Insights</h3>
            
            <div class="performance-grid">
                <div class="performance-card champion-card">
                    <h4>Family Performance</h4>
                    <p><strong>V4 Family Average:</strong> 63.5%</p>
                    <p><strong>V5 Family Average:</strong> 40.9%</p>
                    <div class="metric-large" style="color: #27ae60;">22.6%</div>
                    <div class="metric-label-large">V4 Performance Advantage</div>
                </div>
                <div class="performance-card good-card">
                    <h4>Complexity Impact</h4>
                    <p><strong>Correlation:</strong> -0.640</p>
                    <p><strong>Relationship:</strong> Negative</p>
                    <div class="metric-large" style="color: #e74c3c;">Higher Complexity</div>
                    <div class="metric-label-large">→ Lower Performance</div>
                </div>
                <div class="performance-card poor-card">
                    <h4>Parameter Efficiency</h4>
                    <p><strong>V4:</strong> 81.4% per parameter</p>
                    <p><strong>V5 Average:</strong> 6-12% per parameter</p>
                    <div class="metric-large" style="color: #f1c40f;">7-14x</div>
                    <div class="metric-label-large">V4 Efficiency Advantage</div>
                </div>
            </div>
        </div>

        <div id="implementation-guidelines">
            <h2>Implementation Guidelines</h2>

            <h3>V4 Production Implementation</h3>
            <div class="code-container">
class ProductionRocksDBPredictor:
    """Production-ready V4 model implementation"""
    
    def __init__(self):
        self.record_size = 1040  # bytes
        self.phase_thresholds = {
            'initial_max_minutes': 30,
            'middle_max_minutes': 90
        }
        self.utilization_factors = {
            'initial': 0.019,
            'middle': 0.047,
            'final': 0.046
        }
    
    def measure_device_performance(self, device_path):
        """Measure current device write bandwidth"""
        import subprocess
        import re
        
        # Use iostat to measure device performance
        cmd = ['iostat', '-x', '1', '3', device_path]
        result = subprocess.run(cmd, capture_output=True, text=True)
        
        # Parse iostat output for write bandwidth
        # This is a simplified example - production code needs robust parsing
        lines = result.stdout.split('\n')
        for line in lines:
            if device_path in line:
                fields = line.split()
                write_kb_per_sec = float(fields[9])  # Adjust index based on iostat format
                write_mb_per_sec = write_kb_per_sec / 1024
                return write_mb_per_sec
        
        raise ValueError(f"Could not measure performance for {device_path}")
    
    def detect_operational_phase(self, runtime_minutes, db_size_gb=None):
        """Detect current RocksDB operational phase"""
        if runtime_minutes <= self.phase_thresholds['initial_max_minutes']:
            return 'initial'
        elif runtime_minutes <= self.phase_thresholds['middle_max_minutes']:
            return 'middle'
        else:
            return 'final'
    
    def predict_sustainable_put_rate(self, device_path='/dev/nvme0n1', 
                                   runtime_minutes=0):
        """Main prediction function for production use"""
        try:
            # Measure current device performance
            device_bw_mbps = self.measure_device_performance(device_path)
            
            # Detect operational phase
            phase = self.detect_operational_phase(runtime_minutes)
            
            # Calculate V4 prediction
            theoretical_ops_per_sec = (device_bw_mbps * 1024 * 1024) / self.record_size
            utilization = self.utilization_factors[phase]
            predicted_s_max = theoretical_ops_per_sec * utilization
            
            # Confidence assessment
            confidence_level = {
                'initial': 'medium',  # Higher volatility
                'middle': 'high',     # V4 performs well
                'final': 'high'       # V4 best performance
            }[phase]
            
            return {
                'predicted_s_max_ops_per_sec': int(predicted_s_max),
                'device_bandwidth_mbps': device_bw_mbps,
                'operational_phase': phase,
                'utilization_factor': utilization,
                'confidence': confidence_level,
                'model_version': 'V4_device_envelope',
                'prediction_timestamp': time.time()
            }
            
        except Exception as e:
            return {
                'error': str(e),
                'fallback_recommendation': 'Use conservative estimate based on historical data'
            }
```

            <h3>Model Selection Decision Tree</h3>
            <div class="code-container">
def select_optimal_model(use_case, performance_requirements, complexity_tolerance):
    """
    Decision framework for model selection
    
    Args:
        use_case: 'production', 'research', 'phase_specific'
        performance_requirements: 'high', 'medium', 'low'
        complexity_tolerance: 'low', 'medium', 'high'
    
    Returns:
        Recommended model and rationale
    """
    
    if use_case == 'production':
        if performance_requirements == 'high':
            return {
                'model': 'V4_device_envelope',
                'rationale': 'Highest overall accuracy (81.4%) with minimal complexity',
                'confidence': 'high'
            }
        else:
            return {
                'model': 'V4_device_envelope',
                'rationale': 'Robust performance, simple implementation',
                'confidence': 'high'
            }
    
    elif use_case == 'phase_specific':
        return {
            'initial_phase': 'V5_original (if volatility handling critical)',
            'middle_phase': 'V4_1_temporal (96.9% accuracy)',
            'final_phase': 'V4_device_envelope (86.6% accuracy)',
            'rationale': 'Phase-specific optimization based on empirical results'
        }
    
    elif use_case == 'research':
        return {
            'positive_example': 'V4_device_envelope (study success factors)',
            'negative_example': 'V5_family (study failure modes)',
            'rationale': 'Learn from both success and failure patterns'
        }
    
    else:
        return {
            'model': 'V4_device_envelope',
            'rationale': 'Default choice - proven performance and simplicity'
        }
            </div>
        </div>

        <div id="research-insights">
            <h2>Research Insights</h2>

            <h3>Information Theory Perspective</h3>
            <div class="insight-panel">
                <h4>Why V4 Achieves Maximum Information Efficiency</h4>
                
                <div class="code-container">
INFORMATION EFFICIENCY ANALYSIS:

V4 Approach:
- Information Sources: 1 (device_write_bw)
- Information Content: High (captures primary constraint)
- Redundancy: 0%
- Signal-to-Noise Ratio: Maximum
- Accuracy per Bit of Information: Optimal

V5 Approach:
- Information Sources: 5-7 (multiple parameters)
- Information Content: Low per parameter (same info repeated)
- Redundancy: 20-43%
- Signal-to-Noise Ratio: Degraded
- Accuracy per Bit of Information: Suboptimal
                </div>

                <p><strong>Key Insight</strong>: V4's single parameter contains more useful information than V5's multiple parameters combined.</p>
            </div>

            <h3>Systems Theory Analysis</h3>
            <div class="insight-panel">
                <h4>Constraint Theory Application</h4>
                
                <p><strong>Theory of Constraints</strong>: System performance is limited by its weakest link (bottleneck).</p>
                
                <div class="performance-grid">
                    <div class="performance-card good-card">
                        <h5>V4 Approach (Correct)</h5>
                        <ul class="feature-list">
                            <li>Identify THE bottleneck (device I/O)</li>
                            <li>Model this constraint accurately</li>
                            <li>Ignore non-bottleneck factors</li>
                            <li>Achieve maximum accuracy</li>
                        </ul>
                    </div>
                    <div class="performance-card poor-card">
                        <h5>V5 Approach (Incorrect)</h5>
                        <ul class="issue-list">
                            <li>Model ALL potential constraints</li>
                            <li>Treat consequences as independent causes</li>
                            <li>Create conflicting constraint signals</li>
                            <li>Achieve lower accuracy despite more effort</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3>Temporal Modeling Insights</h3>
            <div class="insight-panel">
                <h4>V4.1 Success vs V5 Temporal Failures</h4>
                
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Aspect</th>
                            <th>V4.1 Temporal (Success)</th>
                            <th>V5 Temporal Models (Failure)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Complexity Level</strong></td>
                            <td>Appropriate (2-3 factors)</td>
                            <td>Excessive (5-7 factors)</td>
                        </tr>
                        <tr>
                            <td><strong>Temporal Approach</strong></td>
                            <td>Natural phase evolution</td>
                            <td>Over-engineered temporal integration</td>
                        </tr>
                        <tr>
                            <td><strong>Base Foundation</strong></td>
                            <td>Builds on V4 success</td>
                            <td>Dilutes V4 success factors</td>
                        </tr>
                        <tr>
                            <td><strong>Parameter Independence</strong></td>
                            <td>Maintains independence</td>
                            <td>Violates independence</td>
                        </tr>
                        <tr>
                            <td><strong>Result</strong></td>
                            <td>78.6% average, 96.9% peak</td>
                            <td>27.8-60.8% average</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="insight-panel">
            <h2 id="conclusion">Conclusion: The Great Model Experiment</h2>
            
            <h3>Fundamental Discoveries</h3>
            <ol>
                <li><strong>Simplicity Principle Validated</strong>: V4's single-constraint approach beats all multi-constraint V5 approaches</li>
                <li><strong>Parameter Independence Critical</strong>: Redundant parameters harm performance more than help</li>
                <li><strong>Information Efficiency Matters</strong>: Quality of information > Quantity of parameters</li>
                <li><strong>Constraint Identification Key</strong>: Finding the right constraint > Modeling all constraints</li>
                <li><strong>Temporal Modeling Nuanced</strong>: V4.1 shows it can work, but V5 over-engineers it</li>
            </ol>

            <h3>Practical Implications</h3>
            <div class="performance-grid">
                <div class="performance-card champion-card">
                    <h4>For Production Systems</h4>
                    <ul class="feature-list">
                        <li>Use V4 Device Envelope Model</li>
                        <li>Monitor device bandwidth as primary metric</li>
                        <li>Apply phase-specific utilization factors</li>
                        <li>Expect 80%+ accuracy with high consistency</li>
                    </ul>
                </div>
                <div class="performance-card good-card">
                    <h4>For Research</h4>
                    <ul class="feature-list">
                        <li>Study V4's implicit factor integration</li>
                        <li>Analyze V4.1's temporal modeling success</li>
                        <li>Learn from V5's failure modes</li>
                        <li>Develop parameter independence tools</li>
                    </ul>
                </div>
                <div class="performance-card poor-card">
                    <h4>What NOT to Do</h4>
                    <ul class="issue-list">
                        <li>Don't add parameters without independence verification</li>
                        <li>Don't model consequences as independent causes</li>
                        <li>Don't assume more complexity = better accuracy</li>
                        <li>Don't ignore the power of focused simplicity</li>
                    </ul>
                </div>
            </div>

            <h3>The Ultimate Lesson</h3>
            <div class="hero-section">
                <h3 style="color: white; margin: 0;">V4's 81.4% accuracy with 1 constraint</h3>
                <h3 style="color: white; margin: 10px 0;">beats</h3>
                <h3 style="color: white; margin: 0;">V5's best 60.8% accuracy with 5+ constraints</h3>
                <p style="font-size: 1.3em; margin-top: 20px;">A testament to the power of focused simplicity in systems modeling</p>
            </div>
        </div>

        <hr style="margin: 40px 0; border: none; height: 2px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
        <p style="text-align: center; color: #7f8c8d;"><em>Document Version: 1.0 | Last Updated: 2025-09-20 | Technical Analysis Based on: 2025-09-12 Experimental Results</em></p>
    </div>
</body>
</html>
