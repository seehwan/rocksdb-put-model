# RocksDB Put-Rate Model 실험 최종 보고서

**실험 일시**: 2025-09-05  
**실험 환경**: GPU-01 서버  
**디바이스**: /dev/nvme1n1p1 (NVMe SSD)  
**실험자**: yooseehwan  
**상태**: ✅ 완료  

## 📋 실험 개요

### 목적
RocksDB의 steady-state에서 최대 지속 가능한 put rate (S_max)를 이론적으로 모델링하고, 실제 시스템에서 검증하는 것이 목적입니다.

### 실험 단계
- **Phase-A**: 디바이스 캘리브레이션
- **Phase-B**: RocksDB 벤치마크 실행
- **Phase-C**: Per-Level WAF 분석
- **Phase-D**: 모델 검증

## 📊 Phase별 결과 요약

### Phase-A: 디바이스 캘리브레이션
| 측정 항목 | 순수 성능 | 혼합 성능 | 성능 저하율 |
|-----------|-----------|-----------|-------------|
| **읽기** | 2368 MiB/s | 1116 MiB/s | **-53%** |
| **쓰기** | 1484 MiB/s | 1115 MiB/s | **-25%** |
| **혼합** | - | 2231 MiB/s | - |

**핵심 발견**: 혼합 워크로드에서 상당한 성능 저하 확인

### Phase-B: RocksDB 벤치마크
- **실제 성능**: 187.1 MiB/s (188,617 ops/s)
- **압축률 (CR)**: 0.54 (54% 압축 효과)
- **Write Amplification (WA)**: 1.02 (STATISTICS 기반)
- **실행 시간**: 4.7시간 (32억 operations)
- **Stall 비율**: 45.31%

**핵심 발견**: 예상보다 3-4배 높은 성능 달성

### Phase-C: Per-Level WAF 분석
| Level | Write (GB) | W-Amp | 비고 |
|-------|------------|-------|------|
| **L0** | 1,670.1 | 0.0 | Flush only |
| **L1** | 1,036.0 | 0.0 | Low WA |
| **L2** | 3,968.1 | 22.6 | **주요 병목** |
| **L3** | 2,096.4 | 0.9 | Medium WA |

**총 WA**: 2.87 (LOG 기반)

**핵심 발견**: L2가 전체 쓰기의 45.2% 차지하며 주요 병목

### Phase-D: 모델 검증
| 항목 | 예측값 | 실제값 | 오류율 |
|------|--------|--------|--------|
| **S_max** | 582.0 MiB/s | 187.1 MiB/s | **-67.8%** |
| **WA** | 2.87 | 1.02 (STATISTICS) | **-64.4%** |

**검증 상태**: ❌ 실패 (10% 목표 대비 67.8% 오류)

## 🔍 주요 발견사항

### 1. WA 측정 방법의 큰 차이
- **STATISTICS**: 1.02 (전체 시스템 통계)
- **LOG**: 2.87 (Compaction Stats)
- **차이**: 2.8배

### 2. 모델 예측의 한계
- **과대 예측**: 3.1배 높은 성능 예측
- **원인**: 단순화된 가정, 실제 환경 복잡성 미반영

### 3. L2가 주요 병목
- **쓰기 비중**: 45.2% (3,968.1 / 8,770.6 GB)
- **WA**: 22.6 (가장 높음)
- **최적화 필요**: Compaction 전략 개선 필요

## ⚠️ 문제점 및 한계

### 1. 측정 방법의 불일치
- STATISTICS vs LOG WA 값의 큰 차이
- 측정 시점 및 범위의 차이
- 표준화된 측정 방법론 필요

### 2. 모델의 한계
- 실제 환경의 복잡성 미반영
- 정적 모델의 한계
- 동적 환경 변화 미고려

### 3. 실험 환경의 제약
- 단일 디바이스 환경
- 특정 워크로드 패턴
- 제한된 파라미터 조합

## 📈 개선 방안

### 1. 측정 방법 통일
- STATISTICS와 LOG 값의 일치성 확보
- 시간대별 WA 변화 추이 분석
- 표준화된 측정 방법론 수립

### 2. 모델 개선
- 실제 환경의 복잡성 반영
- Level별 상세 모델링
- 동적 파라미터 조정

### 3. L2 최적화
- 높은 WA 원인 파악
- Compaction 전략 최적화
- 크기비(T) 조정 검토

## 🎯 결론

### 실험 성과
1. **체계적 검증**: 4단계 검증 프로세스 완료
2. **문제점 식별**: WA 측정 불일치 및 모델 한계 발견
3. **개선 방향**: 구체적인 개선 방안 제시

### 검증 결과
- **모델 정확도**: 67.8% 오류 (목표 10% 대비)
- **주요 원인**: WA 측정 불일치 및 모델 한계
- **개선 필요**: 측정 방법 통일 및 모델 개선

### 다음 단계
1. WA 측정 방법 일치성 확보
2. 모델 개선 및 실제 환경 반영
3. L2 최적화를 통한 성능 개선
4. 추가 파라미터 조합 실험

## 📁 생성된 파일

### Phase-A
- `device_calibration_results.md`: 디바이스 성능 측정 결과

### Phase-B
- `benchmark_results.txt`: RocksDB 벤치마크 상세 결과
- `summary.md`: Phase-B 요약

### Phase-C
- `waf_analysis.json`: Level별 WAF 데이터
- `phase_c_summary.md`: Phase-C 요약

### Phase-D
- `model_validation_results.json`: 모델 검증 결과
- `phase_d_summary.md`: Phase-D 요약

### 전체
- `experiment_data.json`: 실험 메타데이터
- `experiment_final_report.md`: 이 최종 보고서

---

**실험 완료일**: 2025-09-05  
**총 소요시간**: 약 8시간  
**상태**: ✅ 완료  
**다음 단계**: 모델 개선 및 추가 실험
