# Phase-C: Per-Level WAF ë¶„ì„ ì‹¤í–‰ ê°€ì´ë“œ

**ì‹¤í–‰ ì¼ì‹œ**: 2025-09-05  
**ëª©ì **: RocksDB LOGì—ì„œ Per-Level Write Amplification ë¶„ì„  

## ğŸ¯ Phase-C ëª©í‘œ

1. **Per-Level WAF ê³„ì‚°**: ê° ë ˆë²¨ë³„ ì“°ê¸° ì•°í”Œë¦¬í”¼ì¼€ì´ì…˜ ë¶„ì„
2. **Mass Balance ê²€ì¦**: ì´ë¡ ì  ì˜ˆì¸¡ê³¼ ì‹¤ì œ ì¸¡ì •ê°’ ë¹„êµ
3. **Read Amplification (RA_c) ê³„ì‚°**: ì½ê¸° ì•°í”Œë¦¬í”¼ì¼€ì´ì…˜ ë¶„ì„

## ğŸ“‹ ì‚¬ì „ ì¤€ë¹„ì‚¬í•­

### 1. LOG íŒŒì¼ í™•ì¸
```bash
# LOG íŒŒì¼ ìœ„ì¹˜ í™•ì¸
ls -la ./log/LOG

# LOG íŒŒì¼ í¬ê¸° í™•ì¸
du -h ./log/LOG

# LOG íŒŒì¼ ë‚´ìš© ë¯¸ë¦¬ë³´ê¸°
head -20 ./log/LOG
```

### 2. í•„ìš”í•œ ìŠ¤í¬ë¦½íŠ¸ í™•ì¸
```bash
# WAF ë¶„ì„ê¸° í™•ì¸
ls -la scripts/waf_analyzer.py

# ì‹¤í–‰ ê¶Œí•œ í™•ì¸
chmod +x scripts/waf_analyzer.py
```

## ğŸš€ Phase-C ì‹¤í–‰ ë‹¨ê³„

### 1. WAF ë¶„ì„ ì‹¤í–‰
```bash
# ê¸°ë³¸ WAF ë¶„ì„
python3 scripts/waf_analyzer.py --log ./log/LOG \
  --user-mb 1000 --out-dir phase-c-results --plot

# ê²°ê³¼ í™•ì¸
ls -la phase-c-results/
cat phase-c-results/summary.json
```

### 2. Per-Level Breakdown ì‹¤í–‰
```bash
# ë ˆë²¨ë³„ I/O ë¶„í•´
python3 scripts/per_level_breakdown.py --log ./log/LOG \
  --output-dir phase-c-results
```

### 3. ê²°ê³¼ ë¶„ì„
```bash
# ìƒì„±ëœ íŒŒì¼ë“¤ í™•ì¸
ls -la phase-c-results/

# CSV ë°ì´í„° í™•ì¸
head -10 phase-c-results/waf_per_level.csv

# ê·¸ë˜í”„ í™•ì¸
ls -la phase-c-results/*.png
```

## ğŸ“Š ì˜ˆìƒ ê²°ê³¼

### Per-Level WAF í…Œì´ë¸”
```
Level                Read(MiB/s)   Write(MiB/s)   %ReadBW  %WriteBW
-------------------------------------------------------------------
L0 (flush)               ___.__        ___.__      __._%      __._%
L1                      ___.__        ___.__      __._%      __._%
L2                      ___.__        ___.__      __._%      __._%
L3                      ___.__        ___.__      __._%      __._%
L4                      ___.__        ___.__      __._%      __._%
L5                      ___.__        ___.__      __._%      __._%
L6                      ___.__        ___.__      __._%      __._%
WAL                       ___.__        ___.__      __._%      __._%
-------------------------------------------------------------------
TOTAL                    ___.__        ___.__      __._%      __._%
```

### Mass Balance ê²€ì¦
- **ì˜ˆìƒ ì´ ì“°ê¸°**: ___ MB
- **ì‹¤ì œ ì´ ì“°ê¸°**: ___ MB  
- **ì˜¤ë¥˜ìœ¨**: ___% (â‰¤10% ëª©í‘œ)
- **ê²€ì¦ ìƒíƒœ**: [ ] í†µê³¼ [ ] ì‹¤íŒ¨

## ğŸ” ë¶„ì„ í¬ì¸íŠ¸

### 1. ë ˆë²¨ë³„ íŠ¹ì„±
- **L0 (Flush)**: Memtableì—ì„œì˜ ì§ì ‘ ì“°ê¸°
- **L1-L6 (Compaction)**: ë ˆë²¨ë³„ Compaction ì“°ê¸°
- **WAL**: Write-Ahead Log ì“°ê¸°

### 2. ë³‘ëª© ì§€ì  ì‹ë³„
- ê°€ì¥ ë†’ì€ Write ë¶€í•˜ê°€ ìˆëŠ” ë ˆë²¨
- ê°€ì¥ ë†’ì€ Read ë¶€í•˜ê°€ ìˆëŠ” ë ˆë²¨
- ì´ I/O ëŒ€ì—­í­ ì‚¬ìš©ë¥ 

### 3. ì˜ˆìƒ vs ì‹¤ì œ ë¹„êµ
- Phase-Bì—ì„œ ì¸¡ì •ëœ WA (1.02)ì™€ ë¹„êµ
- ëª¨ë¸ ê°€ì •ê°’ê³¼ì˜ ì°¨ì´ ë¶„ì„

## ğŸ“ ê²°ê³¼ íŒŒì¼

### ìƒì„±ë  íŒŒì¼ë“¤
- `waf_per_level.csv`: ë ˆë²¨ë³„ WAF ë°ì´í„°
- `waf_per_level.png`: ë ˆë²¨ë³„ WAF ë§‰ëŒ€ ê·¸ë˜í”„
- `summary.json`: ë¶„ì„ ìš”ì•½ (JSON í˜•ì‹)
- `per_level_breakdown.csv`: ë ˆë²¨ë³„ ìƒì„¸ ë¶„ì„

### ê²°ê³¼ ì €ì¥ ìœ„ì¹˜
```
experiments/2025-09-05/phase-c/
â”œâ”€â”€ phase_c_instructions.md    # ì´ íŒŒì¼
â”œâ”€â”€ phase-c-results/           # ë¶„ì„ ê²°ê³¼
â”‚   â”œâ”€â”€ waf_per_level.csv
â”‚   â”œâ”€â”€ waf_per_level.png
â”‚   â”œâ”€â”€ summary.json
â”‚   â””â”€â”€ per_level_breakdown.csv
â””â”€â”€ phase_c_summary.md         # ë¶„ì„ ìš”ì•½ (ì™„ë£Œ í›„ ìƒì„±)
```

## ğŸ¯ ì„±ê³µ ê¸°ì¤€

### ì •ëŸ‰ì  ê¸°ì¤€
- [ ] Mass Balance ì˜¤ë¥˜ìœ¨ â‰¤ 10%
- [ ] Per-Level WAF ë°ì´í„° ì •ìƒ ìƒì„±
- [ ] ê·¸ë˜í”„ ë° ì‹œê°í™” ì™„ë£Œ

### ì •ì„±ì  ê¸°ì¤€
- [ ] ë ˆë²¨ë³„ íŠ¹ì„± ëª…í™•íˆ íŒŒì•…
- [ ] ë³‘ëª© ì§€ì  ì‹ë³„ ì™„ë£Œ
- [ ] Phase-D ëª¨ë¸ ê²€ì¦ì„ ìœ„í•œ ë°ì´í„° ì¤€ë¹„

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

Phase-C ì™„ë£Œ í›„:
1. **Phase-D**: ëª¨ë¸ ê²€ì¦ (S_max ê³„ì‚° ë° ê²€ì¦)
2. **Phase-A**: ë””ë°”ì´ìŠ¤ ìº˜ë¦¬ë¸Œë ˆì´ì…˜ (í•„ìš”ì‹œ)
3. **Phase-E**: ë¯¼ê°ë„ ë¶„ì„ (ì„ íƒì‚¬í•­)

---
**ì‹œì‘ì¼**: 2025-09-05  
**ìƒíƒœ**: [ ] ì§„í–‰ì¤‘ [ ] ì™„ë£Œ  
**ì˜ˆìƒ ì†Œìš”ì‹œê°„**: 30-60ë¶„
