# Phase-E: v4 모델 민감도 분석

**실행 일시**: 2025-09-05  
**모델 버전**: v4  
**목표**: v4 모델의 주요 파라미터들이 S_max 예측에 미치는 영향을 정량적으로 분석

## 🎯 민감도 분석 목표

v4 모델의 주요 파라미터들이 S_max 예측에 미치는 영향을 정량적으로 분석하여:

1. **핵심 파라미터 식별**: S_max에 가장 큰 영향을 미치는 파라미터
2. **튜닝 가이드 제공**: 성능 최적화를 위한 파라미터 조정 방향
3. **모델 안정성 평가**: 파라미터 변화에 대한 모델의 견고성
4. **실제 데이터 기반 분석**: Phase-A fio 데이터를 활용한 현실적 분석

## 📊 분석 대상 파라미터

### 1. Write Amplification (WA)
- **범위**: 0.5 ~ 4.0
- **영향**: LSM-tree 구조에서 쓰기 증폭 정도
- **예상 민감도**: High (0.8+)

### 2. Compression Ratio (CR)
- **범위**: 0.2 ~ 0.9
- **영향**: 압축률이 I/O 요구량에 미치는 영향
- **예상 민감도**: High (0.8+)

### 3. Device Bandwidth
- **범위**: 0.5x ~ 1.5x (기준값 대비)
- **영향**: 읽기/쓰기 대역폭이 성능에 미치는 영향
- **예상 민감도**: Medium (0.5-0.8)

### 4. Level Capacity
- **범위**: 0.3x ~ 2.0x (기준값 대비)
- **영향**: 각 LSM 레벨의 용량 제약
- **예상 민감도**: Medium (0.5-0.8)

### 5. Stall Parameters
- **범위**: L0 stall threshold 2 ~ 10
- **영향**: 쓰기 스톨 현상이 성능에 미치는 영향
- **예상 민감도**: Medium (0.5-0.8)

## 🔬 분석 방법

### 1. 단일 파라미터 분석
- 각 파라미터를 독립적으로 변화시키며 S_max 측정
- 파라미터 변화율 대비 S_max 변화율 계산
- 민감도 점수 = (S_max 변화율) / (파라미터 변화율)

### 2. 시뮬레이션 기반 분석
- v4 모델의 완전한 시뮬레이션 실행
- Device Envelope 모델 활용
- Closed Ledger Accounting 적용

### 3. 정량적 평가
- **민감도 점수**: 0.0 ~ 1.0 (높을수록 민감)
- **영향 비율**: 최대값/최소값 (변화폭)
- **상관관계**: 파라미터 간 상호작용

## 📈 생성되는 시각화

### 1. 파라미터 민감도 순위
- 막대 그래프로 파라미터별 민감도 점수 표시
- High/Medium/Low 민감도 구분

### 2. 파라미터별 영향도
- 각 파라미터의 변화에 따른 S_max 변화 곡선
- 기준값 대비 상대적 변화 표시

### 3. 상관관계 히트맵
- 파라미터 간 상관관계 매트릭스
- 상호작용 패턴 식별

## 🚀 실행 방법

```bash
cd /home/sslab/rocksdb-put-model/experiments/2025-09-05/phase-e
python v4_sensitivity_analysis.py
```

## 📋 출력 파일

- `v4_sensitivity_analysis_results.json`: 상세 분석 결과
- `v4_parameter_sensitivity_ranking.png`: 민감도 순위 시각화
- `v4_parameter_impact_analysis.png`: 파라미터별 영향도 시각화
- `v4_parameter_correlation_heatmap.png`: 상관관계 히트맵

## 🎯 기대 결과

### 1. 파라미터 우선순위
- 성능 최적화에 가장 중요한 파라미터 식별
- 튜닝 우선순위 제공

### 2. 최적화 가이드
- 각 파라미터의 최적 범위 제안
- 성능 향상을 위한 구체적 방향

### 3. 모델 검증
- v4 모델의 파라미터 민감도가 현실적인지 확인
- 이론적 예측과 실제 동작의 일치성 검증

## 📊 v4 모델의 특징

### 1. 실제 데이터 기반
- Phase-A fio 데이터를 활용한 Device Envelope 모델
- 현실적인 파라미터 범위 사용

### 2. 완전한 구현
- Python 모듈 기반의 정확한 시뮬레이션
- HTML 시뮬레이터 대비 높은 정확도

### 3. 종합적 분석
- 단일 파라미터뿐만 아니라 상호작용도 고려
- 실제 운영 환경과 유사한 조건

## 🔍 분석 결과 활용

### 1. 성능 튜닝
- 민감도가 높은 파라미터 우선 최적화
- 비용 대비 효과가 큰 파라미터 식별

### 2. 시스템 설계
- RocksDB 설정 최적화
- 하드웨어 요구사항 결정

### 3. 모델 개선
- 민감도 분석 결과를 바탕으로 한 모델 개선
- 새로운 파라미터 추가 고려

## 📁 생성된 파일

- `sensitivity_analysis.py`: 민감도 분석 스크립트
- `sensitivity_results.json`: 분석 결과 (JSON)
- `sensitivity_report.html`: 분석 보고서 (HTML)
- `parameter_sensitivity_ranking.png`: 민감도 순위 시각화
- `parameter_impact_analysis.png`: 파라미터별 영향도 분석
- `parameter_correlation_heatmap.png`: 파라미터 상관관계 히트맵

---

**참고**: 이 분석은 v4 모델의 완전한 구현을 기반으로 하므로, 이전 버전 대비 더 정확하고 현실적인 결과를 제공합니다.
